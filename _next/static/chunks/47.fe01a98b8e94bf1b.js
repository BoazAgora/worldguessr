(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47],{35:(e,n,t)=>{"use strict";t.d(n,{N:()=>i,V:()=>c});var l=t(4232),r=t(5947),a=t(5073),s=t(1567),o=t(8420);function i(e,n){(0,l.useEffect)(function(){return(n.layerContainer??n.map).addLayer(e.instance),function(){n.layerContainer?.removeLayer(e.instance),n.map.removeLayer(e.instance)}},[n,e])}function c(e){return function(n){let t=(0,a.U$)(),l=e((0,o.P)(n,t),t);return(0,r.z)(t.map,n.attribution),(0,s.x)(l.current,n.eventHandlers),i(l.current,t),l}}},723:(e,n,t)=>{"use strict";t.d(n,{T:()=>a});var l=t(4232),r=t(5073);function a(e){return function(n){let t=(0,r.U$)(),a=e(n,t),{instance:s}=a.current,o=(0,l.useRef)(n.position),{position:i}=n;return(0,l.useEffect)(function(){return s.addTo(t.map),function(){s.remove()}},[t.map,s]),(0,l.useEffect)(function(){null!=i&&i!==o.current&&(s.setPosition(i),o.current=i)},[s,i]),a}}},1567:(e,n,t)=>{"use strict";t.d(n,{x:()=>r});var l=t(4232);function r(e,n){let t=(0,l.useRef)();(0,l.useEffect)(function(){return null!=n&&e.instance.on(n),t.current=n,function(){null!=t.current&&e.instance.off(t.current),t.current=null}},[e,n])}},1782:()=>{},2349:(e,n,t)=>{"use strict";t.d(n,{B7:()=>s,KU:()=>i,jU:()=>o});var l=t(4232),r=t(8477),a=t(5073);function s(e){return(0,l.forwardRef)(function(n,t){let{instance:r,context:s}=e(n).current;return(0,l.useImperativeHandle)(t,()=>r),null==n.children?null:l.createElement(a.hL,{value:s},n.children)})}function o(e){return(0,l.forwardRef)(function(n,t){let[a,s]=(0,l.useState)(!1),{instance:o}=e(n,s).current;(0,l.useImperativeHandle)(t,()=>o),(0,l.useEffect)(function(){a&&o.update()},[o,a,n.children]);let i=o._contentNode;return i?(0,r.createPortal)(n.children,i):null})}function i(e){return(0,l.forwardRef)(function(n,t){let{instance:r}=e(n).current;return(0,l.useImperativeHandle)(t,()=>r),null})}},2526:(e,n,t)=>{"use strict";t.d(n,{K:()=>a,Q:()=>r});var l=t(4232);function r(e,n,t){return Object.freeze({instance:e,context:n,container:t})}function a(e,n){return null==n?function(n,t){let r=(0,l.useRef)();return r.current||(r.current=e(n,t)),r}:function(t,r){let a=(0,l.useRef)();a.current||(a.current=e(t,r));let s=(0,l.useRef)(t),{instance:o}=a.current;return(0,l.useEffect)(function(){s.current!==t&&(n(o,t,s.current),s.current=t)},[o,t,r]),a}}},3138:(e,n,t)=>{"use strict";t.d(n,{Po:()=>o,gY:()=>s,ko:()=>a});var l=t(5073),r=t(4232);function a(){return(0,l.U$)().map}function s(e,n){let t=a();return(0,r.useEffect)(function(){return t.on(e,n),function(){t.off(e,n)}},[t,e,n]),t}function o(e){let n=a();return(0,r.useEffect)(function(){return n.on(e),function(){n.off(e)}},[n,e]),n}},4986:(e,n,t)=>{"use strict";t.d(n,{T7:()=>p,Nq:()=>m,wk:()=>h,Lt:()=>g,X3:()=>x});var l=t(2349),r=t(723),a=t(2526),s=t(35),o=t(5947),i=t(5073),c=t(1567),u=t(8420),d=t(4232);function p(e){let n=(0,a.K)(function(n,t){return(0,a.Q)(e(n),t)}),t=(0,r.T)(n);return(0,l.KU)(t)}function m(e,n){let t=(0,a.K)(e,n),r=(0,s.V)(t);return(0,l.B7)(r)}function h(e,n){var t;let r=(t=(0,a.K)(e),function(e,l){let r=(0,i.U$)(),a=t((0,u.P)(e,r),r);return(0,o.z)(r.map,e.attribution),(0,c.x)(a.current,e.eventHandlers),n(a.current,r,e,l),a});return(0,l.jU)(r)}function g(e,n){var t;let r=(t=(0,a.K)(e,n),function(e){let n=(0,i.U$)(),l=t((0,u.P)(e,n),n);(0,c.x)(l.current,e.eventHandlers),(0,s.N)(l.current,n);var r=l.current;let a=(0,d.useRef)();return(0,d.useEffect)(function(){if(e.pathOptions!==a.current){let n=e.pathOptions??{};r.instance.setStyle(n),a.current=n}},[r,e]),l});return(0,l.B7)(r)}function x(e,n){let t=(0,a.K)(e,n),r=(0,s.V)(t);return(0,l.KU)(r)}},5073:(e,n,t)=>{"use strict";t.d(n,{U$:()=>i,W4:()=>a,fB:()=>r,hL:()=>o});var l=t(4232);function r(e){return Object.freeze({__version:1,map:e})}function a(e,n){return Object.freeze({...e,...n})}let s=(0,l.createContext)(null),o=s.Provider;function i(){let e=(0,l.useContext)(s);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}},5947:(e,n,t)=>{"use strict";t.d(n,{z:()=>r});var l=t(4232);function r(e,n){let t=(0,l.useRef)(n);(0,l.useEffect)(function(){n!==t.current&&null!=e.attributionControl&&(null!=t.current&&e.attributionControl.removeAttribution(t.current),null!=n&&e.attributionControl.addAttribution(n)),t.current=n},[e,n])}},6594:(e,n,t)=>{"use strict";t.d(n,{R:()=>o});var l=t(4986),r=t(2526),a=t(5073),s=t(6895);let o=(0,l.Lt)(function({positions:e,...n},t){let l=new s.Polyline(e,n);return(0,r.Q)(l,(0,a.W4)(t,{overlayContainer:l}))},function(e,n,t){n.positions!==t.positions&&e.setLatLngs(n.positions)})},7047:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>v});var l=t(7876),r=t(4232),a=t(8847),s=t(3138),o=t(7152),i=t(8040),c=t(6594),u=t(1173),d=t(3679),p=t(5259),m=t(8546),h=t(2446);t(1782);var g=t(5364);let x=a(()=>t.e(32).then(t.bind(t,1032)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),f=a(()=>t.e(32).then(t.bind(t,1032)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),y=e=>{let{mapRef:n,onMapReady:t,history:l,onUserInteraction:a}=e,o=(0,s.ko)();return(0,r.useEffect)(()=>{o&&!n.current&&(n.current=o,t(!0),setTimeout(()=>{o.invalidateSize()},100))},[o,n,t]),(0,r.useEffect)(()=>{if(o&&a){let e=()=>{a()};return o.on("zoomstart",e),o.on("movestart",e),o.on("dragstart",e),()=>{o.off("zoomstart",e),o.off("movestart",e),o.off("dragstart",e)}}},[o,a]),null},v=e=>{var n,t,a,s,v,j,b,w,N,C,L;let{history:D,points:k,time:z,maxPoints:I,button1Press:S,button1Text:E,button2Press:M,button2Text:F,duel:R,data:T,hidden:O,multiplayerState:B,session:W,gameId:A,options:P}=e,{t:U}=(0,u.B)("common"),[H,_]=(0,r.useState)(null),[q,K]=(0,r.useState)(!1),[Z,$]=(0,r.useState)(!1),[G,Q]=(0,r.useState)(!1),[V,X]=(0,r.useState)(null),[Y,J]=(0,r.useState)(!1),[ee,en]=(0,r.useState)(!1),[et,el]=(0,r.useState)(!1),er=(0,r.useRef)(null),ea=(0,r.useRef)(null),es=(0,r.useRef)(null),eo=(0,r.useRef)(null),ei=(0,r.useRef)(null),[ec,eu]=(0,r.useState)(0),[ed,ep]=(0,r.useState)((null==T?void 0:T.oldElo)||0),[em,eh]=(0,r.useState)([]),[eg,ex]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>{window.L?(ea.current=window.L.icon({iconUrl:"./dest.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),es.current=window.L.icon({iconUrl:"./src.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),eo.current=window.L.icon({iconUrl:"./src2.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),$(!0)):setTimeout(e,100)};e()},[]),(0,r.useEffect)(()=>{if(!R&&k){let e=ec||0,n=Date.now(),t=()=>{let l=Math.min((Date.now()-n)/1200,1);eu(Math.round(e+(k-e)*(l<.7?4*Math.pow(l,3):1-Math.pow(-2*l+2,3)/2))),l<1?requestAnimationFrame(t):eu(k)};requestAnimationFrame(t)}},[k,R]),(0,r.useEffect)(()=>{if(R&&T&&"number"==typeof T.oldElo&&"number"==typeof T.newElo&&!eg){let{oldElo:e,newElo:n}=T,t=Math.abs(n-e),l=e,r=setInterval(()=>{ep(l+=l<n?1:-1),l===n&&(clearInterval(r),ex(!0))},t>0?1500/t:0);return()=>clearInterval(r)}},[R,null==T?void 0:T.oldElo,null==T?void 0:T.newElo,eg]),(0,r.useEffect)(()=>{let e=()=>{if(ei.current){let e=ei.current.scrollTop>20;e!==Y&&J(e)}},n=ei.current;if(n)return n.addEventListener("scroll",e),()=>n.removeEventListener("scroll",e)},[Y]),(0,r.useEffect)(()=>{if(!R&&k&&I){let e=k/I*100,n=[],t="gold",l="/platinum_star.png",r="#CD7F32",a="#b6b2b2";e<=20?n=[a]:e<=30?n=[a,a]:e<=45?n=[a,a,a]:e<=50?n=[r,r,a]:e<=60?n=[r,r,r]:e<=62?n=[t,r,r]:e<=65?n=[t,t,r]:e<=79?n=[t,t,t]:e<=82?n=[l,t,t]:e<=85?n=[l,l,t]:e<=100&&(n=[l,l,l]),eh(n)}},[k,R,I]);let ef=(e,n,t,l)=>{let r=(t-e)*Math.PI/180,a=(l-n)*Math.PI/180,s=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371},ey=e=>{if((null==P?void 0:P.units)==="imperial"){let n=.621371*e;return n<.1?"".concat(Math.round(1e3*e*3.28084),"ft"):n<10?"".concat(n.toFixed(1),"mi"):"".concat(Math.round(n),"mi")}return e<1?"".concat(Math.round(1e3*e),"m"):e<10?"".concat(e.toFixed(1),"km"):"".concat(Math.round(e),"km")},ev=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!eL.length)return null;let n=new Map;eL.forEach(e=>{e.players&&Object.entries(e.players).forEach(e=>{let[t,l]=e;n.has(t)||n.set(t,l.username)})});let t=Array.from(n.entries()).map(e=>{let[n,t]=e;return{playerId:n,username:t,totalScore:eL.reduce((e,t)=>{var l,r;return e+((null==(r=t.players)||null==(l=r[n])?void 0:l.points)||0)},0)}}).sort((e,n)=>n.totalScore-e.totalScore);return(e?t:t.slice(0,5)).map((e,n)=>{var t,a,s,o;let i,c=e.playerId===(null==B||null==(t=B.gameData)?void 0:t.myId),u=V===e.playerId;return(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)("div",{className:"round-item round-animation ".concat(u?"active":""),style:{animationDelay:"".concat(.1*n,"s"),cursor:"pointer"},onClick:()=>{var n;V===(n=e.playerId)?X(null):X(n)},children:(0,l.jsxs)("div",{className:"round-header",children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,l.jsxs)("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"8px"},children:[0===n&&(0,l.jsx)(d.SBv,{style:{color:"#FFD700",fontSize:"1.2rem",filter:"drop-shadow(0 2px 4px rgba(255, 215, 0, 0.3))"}}),1===n&&(0,l.jsx)(d.SBv,{style:{color:"#C0C0C0",fontSize:"1.1rem",filter:"drop-shadow(0 2px 4px rgba(192, 192, 192, 0.3))"}}),2===n&&(0,l.jsx)(d.SBv,{style:{color:"#CD7F32",fontSize:"1rem",filter:"drop-shadow(0 2px 4px rgba(205, 127, 50, 0.3))"}})]}),(0,l.jsxs)("span",{className:"round-number",children:["#",n+1," ",e.username," ",c&&(0,l.jsxs)("span",{style:{color:"#888",fontStyle:"italic",marginLeft:"4px"},children:["(",U("you"),")"]})]})]}),(i=e.totalScore,(0,l.jsxs)("span",{className:"round-points",style:{color:"white"},children:[i," ",U("pts")]}))]})}),u&&((a=e.playerId)&&(null==(o=eL[0])||null==(s=o.players)?void 0:s[a])?(0,l.jsx)("div",{style:{marginBottom:"16px",padding:"12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:eL.map((e,n)=>{var t;let r=null==(t=e.players)?void 0:t[a];if(!r)return null;let s=r.lat&&r.long?ef(e.lat,e.long,r.lat,r.long):null;return(0,l.jsxs)("div",{style:{padding:"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.05)",marginBottom:"4px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)("span",{style:{color:"white",fontSize:"0.9rem"},children:U("roundNo",{r:n+1})}),(0,l.jsxs)("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[s&&(0,l.jsx)("span",{style:{color:"#aaa",fontSize:"0.8rem"},children:ey(s)}),(0,l.jsxs)("span",{style:{color:"white",fontWeight:"bold"},children:[r.points||0," ",U("pts")]})]})]},n)})}):null)]},e.playerId)})},ej=e=>e>=3e3?"#4CAF50":e>=1500?"#FFC107":"#F44336",eb=function(e,n){let t,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=l?"http://maps.google.com/maps?q=&layer=c&panoid=".concat(l,"&cbp=11,0,0,0,0"):"http://maps.google.com/maps?q=&layer=c&cbll=".concat(e,",").concat(n,"&cbp=11,0,0,0,0");let r=window.inCrazyGames,a=void 0!==g&&"true"===g.env.NEXT_PUBLIC_COOLMATH;r||a?navigator.clipboard.writeText(t).then(()=>{h.oR.success(U("copiedToClipboard"))}).catch(()=>{let e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),h.oR.success(U("copiedToClipboard"))}):window.open(t,"_blank")},ew=(e,n)=>{if(n)return"#4CAF50";let t=["#F44336","#2196F3","#FF9800","#9C27B0","#00BCD4"];return t[Math.abs(e.split("").reduce((e,n)=>(e=(e<<5)-e+n.charCodeAt(0))&e,0))%t.length]};(0,r.useEffect)(()=>{q&&eL.length>0&&Z&&!ee&&setTimeout(()=>{(()=>{if(!er.current||!eL.length||!window.L)return;let e=er.current,n=window.L.latLngBounds();eL.forEach(e=>{n.extend([e.lat,e.long]),e.guessLat&&e.guessLong&&n.extend([e.guessLat,e.guessLong]),e.players&&Object.values(e.players).forEach(e=>{e.lat&&e.long&&n.extend([e.lat,e.long])})});try{n.isValid()&&e.fitBounds(n,{padding:[20,20]})}catch(e){console.error("Error fitting map to bounds:",e)}})()},200)},[q,Z,ee]);let eN=e=>{_(e),window.innerWidth<=1024?Q(!G):(e=>{if(!er.current||!eL[e]||!window.L)return;let n=eL[e],t=er.current;if(n.guessLat&&n.guessLong){let e=(e=>e<1?15:e<5?13:e<25?11:e<100?9:e<500?7:e<2e3?5:3)(ef(n.lat,n.long,n.guessLat,n.guessLong)),l=window.L.latLngBounds([[n.lat,n.long],[n.guessLat,n.guessLong]]);n.players&&Object.values(n.players).forEach(e=>{e.lat&&e.long&&l.extend([e.lat,e.long])}),t.flyToBounds(l,{padding:[50,50],maxZoom:e,duration:1.5,easeLinearity:.25})}else t.flyTo([n.lat,n.long],10,{duration:1.5,easeLinearity:.25})})(e)},eC=(0,r.useMemo)(()=>{var e;if(D&&D.length>0)return D;if(null==B||null==(e=B.gameData)?void 0:e.roundHistory){let{roundHistory:e,myId:n,duel:t,public:l}=B.gameData;if(t&&!l)return[];if(e&&e.length>0)return e.map((e,t)=>{let l=e.location,r=e.players[n];return{lat:l.lat,long:l.long,guessLat:null==r?void 0:r.lat,guessLong:null==r?void 0:r.long,points:(null==r?void 0:r.points)||0,players:e.players,timeTaken:null}})}return[]},[D,null==B||null==(n=B.gameData)?void 0:n.roundHistory,null==B||null==(t=B.gameData)?void 0:t.myId,null==B||null==(a=B.gameData)?void 0:a.duel,null==B||null==(s=B.gameData)?void 0:s.public]);if(!Z||!ea.current||!es.current||!eo.current)return(0,l.jsx)("div",{className:"game-summary-container",children:(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"1.5rem"}})});if(!eC||0===eC.length)return(0,l.jsx)("div",{className:"round-over-screen ".concat(O?"hidden":""),children:(0,l.jsx)("div",{className:"game-summary-container",children:(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"1.5rem",padding:"2rem",textAlign:"center"},children:[(0,l.jsx)("div",{children:"No game history available"}),(0,l.jsxs)("div",{style:{fontSize:"1rem",marginTop:"1rem",opacity:.7},children:["Debug: history=",JSON.stringify(D),", roundHistory length=",null==B||null==(N=B.gameData)||null==(w=N.roundHistory)?void 0:w.length]})]})})});let eL=eC;if(R&&T){let{winner:e,draw:n,oldElo:t,newElo:a}=T,s=a-t;return(0,l.jsx)("div",{className:"round-over-screen ".concat(O?"hidden":""),children:(0,l.jsxs)("div",{className:"game-summary-container",children:[(0,l.jsx)("div",{className:"game-summary-map",children:(0,l.jsxs)(x,{center:[0,0],zoom:2,minZoom:1,maxZoom:18,worldCopyJump:!1,zoomControl:window.innerWidth>1024,style:{height:"100%",width:"100%"},children:[(0,l.jsx)(y,{mapRef:er,onMapReady:K,history:eL,onUserInteraction:()=>en(!0)}),(0,l.jsx)(f,{url:"https://mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&hl=".concat(U("lang"))}),eL.map((e,n)=>{var t;let a=null==B||null==(t=B.gameData)?void 0:t.duel;return(0,l.jsxs)(r.Fragment,{children:[(!a||null===H||H===n)&&(0,l.jsx)(o.p,{position:[e.lat,e.long],icon:ea.current,children:(0,l.jsx)(i.z,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:U("roundNo",{r:n+1})}),(0,l.jsx)("br",{}),U("actualLocation"),(0,l.jsx)("div",{style:{marginTop:"8px"},children:(0,l.jsxs)("button",{onClick:()=>eb(e.lat,e.long,e.panoId),style:{background:"#4285f4",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:["\uD83D\uDDFA️ ",U("openInMaps")]})})]})})}),e.guessLat&&e.guessLong&&(()=>{var t;return(null==B||null==(t=B.gameData)?void 0:t.duel)&&null!==H&&H!==n?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.p,{position:[e.guessLat,e.guessLong],icon:es.current,children:(0,l.jsx)(i.z,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:U("yourGuess")}),(0,l.jsx)("br",{}),U("roundNo",{r:n+1}),(0,l.jsx)("br",{}),e.points," ",U("points")]})})}),(0,l.jsx)(c.R,{positions:[[e.lat,e.long],[e.guessLat,e.guessLong]],color:ej(e.points),weight:3,opacity:.7})]})})(),e.players&&Object.entries(e.players).map(t=>{var a,s;let[u,d]=t;return d.lat&&d.long&&u!==(null==B||null==(a=B.gameData)?void 0:a.myId)?(null==B||null==(s=B.gameData)?void 0:s.duel)&&null!==H&&H!==n?null:(ew(u,!1),(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)(o.p,{position:[d.lat,d.long],icon:eo.current,children:(0,l.jsx)(i.z,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:d.username||U("opponent")}),(0,l.jsx)("br",{}),U("roundNo",{r:n+1}),(0,l.jsx)("br",{}),d.points," ",U("points")]})})}),(0,l.jsx)(c.R,{positions:[[e.lat,e.long],[d.lat,d.long]],color:ej(d.points),weight:2,opacity:.5})]},"".concat(n,"-").concat(u))):null})]},n)})]})}),(0,l.jsxs)("div",{className:"game-summary-sidebar ".concat(G?"mobile-expanded":""),children:[(0,l.jsxs)("div",{className:"summary-header duel-header ".concat(Y&&window.innerWidth>1024?"compact":""),children:[(0,l.jsx)("h1",{className:"summary-title",children:n?U("draw"):e?U("victory"):U("defeat")}),"number"==typeof T.oldElo&&"number"==typeof T.newElo&&(0,l.jsxs)("div",{className:"elo-container",children:[(0,l.jsxs)("span",{className:"elo-title",children:[U("elo"),":"]}),(0,l.jsxs)("div",{className:"elo-display",children:[(0,l.jsx)("span",{className:"elo-value",children:ed}),(0,l.jsx)("span",{className:"elo-change",style:{color:s>=0?"green":"red"},children:s>0?"+".concat(s):s})]})]}),T.timeElapsed>0&&(0,l.jsxs)("div",{className:"time-elapsed",children:[(0,l.jsx)(d.w_X,{})," ",U("time"),": ",(0,p.A)(T.timeElapsed)]}),(0,l.jsxs)("div",{className:"summary-actions",children:[(0,l.jsx)("button",{className:"action-btn mobile-expand-btn",onClick:()=>Q(!G),children:G?U("hideDetails"):U("viewDetails")}),E&&(0,l.jsx)("button",{className:"action-btn primary",onClick:S,children:E}),F&&(0,l.jsx)("button",{className:"action-btn secondary",onClick:M,children:F})]})]}),(0,l.jsxs)("div",{className:"rounds-container ".concat(G?"":"mobile-hidden"),ref:ei,children:[(null==B||null==(C=B.gameData)?void 0:C.duel)&&eL.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:U("roundDetails")}),eL.map((e,n)=>{var t,r;let a=null==B||null==(t=B.gameData)?void 0:t.myId,s=null==(r=e.players)?void 0:r[a],o=Object.entries(e.players||{}).filter(e=>{let[n]=e;return n!==a}),i=o.length>0?o[0][1]:null,c=(null==s?void 0:s.points)||0,u=(null==i?void 0:i.points)||0,d=0,p=0;return c<u?d=u-c:u<c&&(p=c-u),(0,l.jsxs)("div",{className:"round-item round-animation ".concat(H===n?"active":""),style:{animationDelay:"".concat(.1*n,"s")},onClick:()=>eN(n),children:[(0,l.jsxs)("div",{className:"round-header",children:[(0,l.jsx)("span",{className:"round-number",children:U("roundNo",{r:n+1})}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.timeTaken&&((null==s?void 0:s.timeTaken)||e.timeTaken)>0&&(0,l.jsxs)("span",{className:"round-points",style:{color:"white"},children:["⏱️ ",(0,m.A)((null==s?void 0:s.timeTaken)||e.timeTaken)]}),window.innerWidth>1024&&e.lat&&e.long&&(0,l.jsx)("button",{className:"gmaps-icon",onClick:n=>{n.stopPropagation(),eb(e.lat,e.long,e.panoId)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"12px",padding:"2px",borderRadius:"3px",backgroundColor:"rgba(255, 255, 255, 0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.2)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",title:U("openInMaps"),children:"\uD83D\uDCCD"})]})]}),(0,l.jsxs)("div",{className:"round-details",children:[(0,l.jsxs)("div",{className:"duel-round-details",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,l.jsxs)("div",{className:"player-score",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[(0,l.jsx)("span",{className:"player-name",style:{fontSize:"0.9em",opacity:"0.8"},children:U("you")}),(0,l.jsxs)("span",{className:"score-points",style:{color:ej(c),fontWeight:"bold"},children:[c," ",U("pts")]}),d>0&&(0,l.jsxs)("span",{className:"health-damage",style:{color:"#ff6b6b",fontSize:"0.85em"},children:["-",d," ❤️"]})]}),!G&&(0,l.jsx)("div",{className:"vs-divider",style:{padding:"0 16px",fontWeight:"bold",color:"rgba(255, 255, 255, 0.6)",fontSize:"0.9em"},children:"VS"}),(0,l.jsxs)("div",{className:"player-score",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[(0,l.jsx)("span",{className:"player-name",style:{fontSize:"0.9em",opacity:"0.8"},children:(null==i?void 0:i.username)||U("opponent")}),(0,l.jsxs)("span",{className:"score-points",style:{color:ej(u),fontWeight:"bold"},children:[u," ",U("pts")]}),p>0&&(0,l.jsxs)("span",{className:"health-damage",style:{color:"#ff6b6b",fontSize:"0.85em"},children:["-",p," ❤️"]})]})]}),(e.distance||e.timeTaken)&&(0,l.jsx)(l.Fragment,{children:e.distance&&e.distance>0&&(0,l.jsxs)("div",{className:"detail-row",children:[(0,l.jsxs)("span",{className:"detail-label",children:[(0,l.jsx)("span",{className:"detail-icon",children:"\uD83D\uDCCF"}),U("distance")]}),(0,l.jsx)("span",{className:"distance-value",children:ey(e.distance)})]})})]})]},n)})]}),(!(null==B||null==(L=B.gameData)?void 0:L.duel)||eL.length>0)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{children:U("finalScores")}),ev(!0)]})]})]})]})})}return(0,l.jsxs)("div",{className:"game-summary-container",children:[(0,l.jsx)("div",{className:"game-summary-map",children:(0,l.jsxs)(x,{center:[0,0],zoom:2,minZoom:1,maxZoom:18,worldCopyJump:!1,zoomControl:window.innerWidth>1024,style:{height:"100%",width:"100%"},children:[(0,l.jsx)(y,{mapRef:er,onMapReady:K,history:D,onUserInteraction:()=>en(!0)}),(0,l.jsx)(f,{url:"https://mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&hl=".concat(U("lang"))}),eL.map((e,n)=>{var t,a;let s=e.guessLat&&e.guessLong?ef(e.lat,e.long,e.guessLat,e.guessLong):null;return(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)(o.p,{position:[e.lat,e.long],icon:ea.current,children:(0,l.jsx)(i.z,{className:"map-marker-popup",children:(0,l.jsxs)("div",{className:"popup-content",children:[(0,l.jsxs)("div",{className:"popup-round",children:[U("roundNumber",{number:n+1})," - ",U("actualLocation")]}),(!(null==B?void 0:B.gameData)||!(null==(t=eL[0])?void 0:t.players)||Object.keys(eL[0].players).length<=1)&&(0,l.jsxs)("div",{className:"popup-points",style:{color:ej(e.points)},children:[e.points," ",U("points")]}),s&&(!(null==B?void 0:B.gameData)||!(null==(a=eL[0])?void 0:a.players)||Object.keys(eL[0].players).length<=1)&&(0,l.jsxs)("div",{className:"popup-distance",children:[U("distance"),": ",ey(s)]}),(0,l.jsx)("div",{className:"popup-actions",children:(0,l.jsxs)("button",{className:"popup-btn gmaps",onClick:()=>eb(e.lat,e.long,e.panoId),children:["\uD83D\uDCCD ",U("openInMaps")]})})]})})}),e.guessLat&&e.guessLong&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.p,{position:[e.guessLat,e.guessLong],icon:es.current,children:(0,l.jsx)(i.z,{className:"map-marker-popup",children:(0,l.jsxs)("div",{className:"popup-content",children:[(0,l.jsxs)("div",{className:"popup-round",children:[U("roundNumber",{number:n+1})," - ",U("yourGuess")]}),(0,l.jsxs)("div",{className:"popup-points",style:{color:ej(e.points)},children:[e.points," ",U("points")]}),(0,l.jsxs)("div",{className:"popup-distance",children:[U("distance"),": ",ey(s)]})]})})}),(0,l.jsx)(c.R,{positions:[[e.lat,e.long],[e.guessLat,e.guessLong]],color:ej(e.points),weight:3,opacity:H===n?1:.6})]}),e.players&&Object.entries(e.players).map(t=>{var a,s;let[u,d]=t;if(d.lat&&d.long&&u!==(null==B||null==(a=B.gameData)?void 0:a.myId)){if(null==B||null==(s=B.gameData)?void 0:s.public){if(!V||u!==V)return null}else if(V&&u!==V)return null;return ew(u,!1),(0,l.jsxs)(r.Fragment,{children:[(0,l.jsx)(o.p,{position:[d.lat,d.long],icon:eo.current,children:(0,l.jsx)(i.z,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:d.username||U("opponent")}),(0,l.jsx)("br",{}),U("roundNo",{r:n+1}),(0,l.jsx)("br",{}),d.points," ",U("points")]})})}),(0,l.jsx)(c.R,{positions:[[e.lat,e.long],[d.lat,d.long]],color:ej(d.points),weight:2,opacity:.5})]},"".concat(n,"-").concat(u))}return null})]},n)})]})}),(0,l.jsxs)("div",{className:"game-summary-sidebar ".concat(G?"mobile-expanded":""),children:[(0,l.jsxs)("div",{className:"summary-header ".concat(Y&&window.innerWidth>1024?"compact":""),style:{transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",...G&&window.innerWidth<=1024?{padding:"8px 16px",minHeight:"auto",transform:"scale(0.95)"}:{paddingTop:window.innerWidth<1024?"15px":"60px"}},children:[(0,l.jsx)("div",{className:"star-container",style:{transition:"all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)",...G&&window.innerWidth<=1024?{margin:"4px 0",transform:"scale(0.7) translateY(-4px)",opacity:.9}:{}},children:em.map((e,n)=>(0,l.jsx)("div",{className:"star",style:{animationDelay:"".concat(.5*n,"s"),transition:"transform 0.3s ease-out"},children:"string"==typeof e&&e.endsWith(".png")?(0,l.jsx)("img",{src:e,alt:"Star ".concat(n),style:{width:"32px",height:"32px",transition:"all 0.3s ease-out"}}):(0,l.jsx)(d.gt3,{className:"star",style:{color:e,transition:"all 0.3s ease-out"}})},n))}),(null==B?void 0:B.gameData)&&!(null==B||null==(v=B.gameData)?void 0:v.duel)&&(null==(j=eL[0])?void 0:j.players)&&Object.keys(eL[0].players).length>1&&(()=>{let e=(()=>{var e;if(!eL.length||!(null==B||null==(e=B.gameData)?void 0:e.myId))return null;let n=new Map;eL.forEach(e=>{e.players&&Object.entries(e.players).forEach(e=>{let[t,l]=e;n.has(t)||n.set(t,l.username)})});let t=Array.from(n.entries()).map(e=>{let[n,t]=e;return{playerId:n,username:t,totalScore:eL.reduce((e,t)=>{var l,r;return e+((null==(r=t.players)||null==(l=r[n])?void 0:l.points)||0)},0)}}).sort((e,n)=>n.totalScore-e.totalScore),l=t.findIndex(e=>{var n;return e.playerId===(null==B||null==(n=B.gameData)?void 0:n.myId)});return -1!==l?{rank:l+1,total:t.length}:null})();return e&&(0,l.jsxs)("div",{style:{color:"white",fontSize:"1.2rem",fontWeight:"bold",textAlign:"center",margin:"8px 0",opacity:.9,transition:"all 0.3s ease-out",...G&&window.innerWidth<=1024?{fontSize:"1rem",margin:"4px 0",transform:"scale(0.9)"}:{}},children:[U("rank")," ",e.rank,"/",e.total]})})(),(0,l.jsx)("div",{className:"summary-score points-display ".concat(ec<k?"animating":""),style:{transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",...G&&window.innerWidth<=1024?{fontSize:"1.5rem",margin:"2px 0",transform:"scale(0.9) translateY(-2px)"}:{}},children:(null==ec?void 0:ec.toFixed(0))||k}),(0,l.jsxs)("div",{className:"summary-total",style:{transition:"all 0.3s ease-out",...G&&window.innerWidth<=1024?{fontSize:"0.8rem",margin:"2px 0",opacity:.8,transform:"translateY(-1px)"}:{}},children:[U("outOf")," ",I," ",U("points")]}),(0,l.jsxs)("div",{className:"summary-actions",children:[(0,l.jsx)("button",{className:"action-btn mobile-expand-btn",onClick:()=>Q(!G),children:G?U("hideDetails"):U("viewDetails")}),E&&(0,l.jsx)("button",{className:"action-btn primary",onClick:S,children:E||"Play Again"}),F&&(0,l.jsx)("button",{className:"action-btn secondary",onClick:M,children:F||"Close"})]})]}),(0,l.jsxs)("div",{className:"rounds-container ".concat(G?"":"mobile-hidden"),ref:ei,children:[(null==B?void 0:B.gameData)&&(null==(b=eL[0])?void 0:b.players)&&Object.keys(eL[0].players).length>1&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:U("finalScores")}),ev(!0)]}),!(null==B?void 0:B.gameData)&&eL&&eL.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:U("roundDetails")}),eL.map((e,n)=>{let t=e.guessLat&&e.guessLong?ef(e.lat,e.long,e.guessLat,e.guessLong):null,r=window.innerWidth<=1024;return(0,l.jsxs)("div",{className:"round-item round-animation ".concat(H===n?"active":""),style:{animationDelay:"".concat(.1*n,"s")},onClick:()=>{eN(n)},children:[(0,l.jsxs)("div",{className:"round-header",children:[(0,l.jsx)("span",{className:"round-number",children:U("roundNo",{r:n+1})}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,l.jsxs)("span",{className:"round-points",style:{color:"white"},children:[e.points," ",U("pts")]}),!r&&(0,l.jsx)("button",{className:"gmaps-icon",onClick:n=>{n.stopPropagation(),eb(e.lat,e.long,e.panoId)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"12px",padding:"2px",borderRadius:"3px",backgroundColor:"rgba(255, 255, 255, 0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.2)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",title:U("openInMaps"),children:"\uD83D\uDCCD"})]})]}),(0,l.jsxs)("div",{className:"round-details",children:[t&&t>0&&(0,l.jsxs)("div",{className:"detail-row",children:[(0,l.jsxs)("span",{className:"detail-label",children:[(0,l.jsx)("span",{className:"detail-icon",children:"\uD83D\uDCCF"}),U("distance")]}),(0,l.jsx)("span",{className:"distance-value",children:ey(t)})]}),e.timeTaken&&e.timeTaken>0&&(0,l.jsxs)("div",{className:"detail-row",children:[(0,l.jsxs)("span",{className:"detail-label",children:[(0,l.jsx)("span",{className:"detail-icon",children:"⏱️"}),U("timeTaken")]}),(0,l.jsx)("span",{className:"time-value",children:(0,m.A)(e.timeTaken)})]}),(()=>{var n;return(null==W||null==(n=W.token)?void 0:n.secret)&&e.xpEarned&&!(e.xpEarned<=0)?(0,l.jsxs)("div",{className:"detail-row",children:[(0,l.jsxs)("span",{className:"detail-label",children:[(0,l.jsx)("span",{className:"detail-icon",children:"⭐"}),"XP"]}),(0,l.jsxs)("span",{className:"xp-value",children:["+",e.xpEarned]})]}):null})()]})]},n)})]})]})]})]})}},7152:(e,n,t)=>{"use strict";t.d(n,{p:()=>o});var l=t(4986),r=t(2526),a=t(5073),s=t(6895);let o=(0,l.Nq)(function({position:e,...n},t){let l=new s.Marker(e,n);return(0,r.Q)(l,(0,a.W4)(t,{overlayContainer:l}))},function(e,n,t){n.position!==t.position&&e.setLatLng(n.position),null!=n.icon&&n.icon!==t.icon&&e.setIcon(n.icon),null!=n.zIndexOffset&&n.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),null!=n.opacity&&n.opacity!==t.opacity&&e.setOpacity(n.opacity),null!=e.dragging&&n.draggable!==t.draggable&&(!0===n.draggable?e.dragging.enable():e.dragging.disable())})},8040:(e,n,t)=>{"use strict";t.d(n,{z:()=>o});var l=t(4986),r=t(2526),a=t(6895),s=t(4232);let o=(0,l.wk)(function(e,n){let t=new a.Popup(e,n.overlayContainer);return(0,r.Q)(t,n)},function(e,n,{position:t},l){(0,s.useEffect)(function(){let{instance:r}=e;function a(e){e.popup===r&&(r.update(),l(!0))}function s(e){e.popup===r&&l(!1)}return n.map.on({popupopen:a,popupclose:s}),null==n.overlayContainer?(null!=t&&r.setLatLng(t),r.openOn(n.map)):n.overlayContainer.bindPopup(r),function(){n.map.off({popupopen:a,popupclose:s}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(r)}},[e,n,l,t])})},8420:(e,n,t)=>{"use strict";function l(e,n){let t=e.pane??n.pane;return t?{...e,pane:t}:e}t.d(n,{P:()=>l})}}]);