(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{35:(n,t,e)=>{"use strict";e.d(t,{N:()=>a,V:()=>c});var r=e(4232),l=e(5947),o=e(5073),u=e(1567),i=e(8420);function a(n,t){(0,r.useEffect)(function(){return(t.layerContainer??t.map).addLayer(n.instance),function(){t.layerContainer?.removeLayer(n.instance),t.map.removeLayer(n.instance)}},[t,n])}function c(n){return function(t){let e=(0,o.U$)(),r=n((0,i.P)(t,e),e);return(0,l.z)(e.map,t.attribution),(0,u.x)(r.current,t.eventHandlers),a(r.current,e),r}}},723:(n,t,e)=>{"use strict";e.d(t,{T:()=>o});var r=e(4232),l=e(5073);function o(n){return function(t){let e=(0,l.U$)(),o=n(t,e),{instance:u}=o.current,i=(0,r.useRef)(t.position),{position:a}=t;return(0,r.useEffect)(function(){return u.addTo(e.map),function(){u.remove()}},[e.map,u]),(0,r.useEffect)(function(){null!=a&&a!==i.current&&(u.setPosition(a),i.current=a)},[u,a]),o}}},1567:(n,t,e)=>{"use strict";e.d(t,{x:()=>l});var r=e(4232);function l(n,t){let e=(0,r.useRef)();(0,r.useEffect)(function(){return null!=t&&n.instance.on(t),e.current=t,function(){null!=e.current&&n.instance.off(e.current),e.current=null}},[n,t])}},1782:()=>{},1937:(n,t,e)=>{"use strict";e.d(t,{m:()=>i});var r=e(4986),l=e(2526),o=e(6895),u=e(4232);let i=(0,r.wk)(function(n,t){let e=new o.Tooltip(n,t.overlayContainer);return(0,l.Q)(e,t)},function(n,t,{position:e},r){(0,u.useEffect)(function(){let l=t.overlayContainer;if(null==l)return;let{instance:o}=n,u=n=>{n.tooltip===o&&(null!=e&&o.setLatLng(e),o.update(),r(!0))},i=n=>{n.tooltip===o&&r(!1)};return l.on({tooltipopen:u,tooltipclose:i}),l.bindTooltip(o),function(){l.off({tooltipopen:u,tooltipclose:i}),null!=l._map&&l.unbindTooltip()}},[n,t,r,e])})},2349:(n,t,e)=>{"use strict";e.d(t,{B7:()=>u,KU:()=>a,jU:()=>i});var r=e(4232),l=e(8477),o=e(5073);function u(n){return(0,r.forwardRef)(function(t,e){let{instance:l,context:u}=n(t).current;return(0,r.useImperativeHandle)(e,()=>l),null==t.children?null:r.createElement(o.hL,{value:u},t.children)})}function i(n){return(0,r.forwardRef)(function(t,e){let[o,u]=(0,r.useState)(!1),{instance:i}=n(t,u).current;(0,r.useImperativeHandle)(e,()=>i),(0,r.useEffect)(function(){o&&i.update()},[i,o,t.children]);let a=i._contentNode;return a?(0,l.createPortal)(t.children,a):null})}function a(n){return(0,r.forwardRef)(function(t,e){let{instance:l}=n(t).current;return(0,r.useImperativeHandle)(e,()=>l),null})}},2526:(n,t,e)=>{"use strict";e.d(t,{K:()=>o,Q:()=>l});var r=e(4232);function l(n,t,e){return Object.freeze({instance:n,context:t,container:e})}function o(n,t){return null==t?function(t,e){let l=(0,r.useRef)();return l.current||(l.current=n(t,e)),l}:function(e,l){let o=(0,r.useRef)();o.current||(o.current=n(e,l));let u=(0,r.useRef)(e),{instance:i}=o.current;return(0,r.useEffect)(function(){u.current!==e&&(t(i,e,u.current),u.current=e)},[i,e,l]),o}}},3138:(n,t,e)=>{"use strict";e.d(t,{Po:()=>i,gY:()=>u,ko:()=>o});var r=e(5073),l=e(4232);function o(){return(0,r.U$)().map}function u(n,t){let e=o();return(0,l.useEffect)(function(){return e.on(n,t),function(){e.off(n,t)}},[e,n,t]),e}function i(n){let t=o();return(0,l.useEffect)(function(){return t.on(n),function(){t.off(n)}},[t,n]),t}},4986:(n,t,e)=>{"use strict";e.d(t,{T7:()=>d,Nq:()=>p,wk:()=>g,Lt:()=>m,X3:()=>v});var r=e(2349),l=e(723),o=e(2526),u=e(35),i=e(5947),a=e(5073),c=e(1567),s=e(8420),f=e(4232);function d(n){let t=(0,o.K)(function(t,e){return(0,o.Q)(n(t),e)}),e=(0,l.T)(t);return(0,r.KU)(e)}function p(n,t){let e=(0,o.K)(n,t),l=(0,u.V)(e);return(0,r.B7)(l)}function g(n,t){var e;let l=(e=(0,o.K)(n),function(n,r){let l=(0,a.U$)(),o=e((0,s.P)(n,l),l);return(0,i.z)(l.map,n.attribution),(0,c.x)(o.current,n.eventHandlers),t(o.current,l,n,r),o});return(0,r.jU)(l)}function m(n,t){var e;let l=(e=(0,o.K)(n,t),function(n){let t=(0,a.U$)(),r=e((0,s.P)(n,t),t);(0,c.x)(r.current,n.eventHandlers),(0,u.N)(r.current,t);var l=r.current;let o=(0,f.useRef)();return(0,f.useEffect)(function(){if(n.pathOptions!==o.current){let t=n.pathOptions??{};l.instance.setStyle(t),o.current=t}},[l,n]),r});return(0,r.B7)(l)}function v(n,t){let e=(0,o.K)(n,t),l=(0,u.V)(e);return(0,r.KU)(l)}},5073:(n,t,e)=>{"use strict";e.d(t,{U$:()=>a,W4:()=>o,fB:()=>l,hL:()=>i});var r=e(4232);function l(n){return Object.freeze({__version:1,map:n})}function o(n,t){return Object.freeze({...n,...t})}let u=(0,r.createContext)(null),i=u.Provider;function a(){let n=(0,r.useContext)(u);if(null==n)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}},5947:(n,t,e)=>{"use strict";e.d(t,{z:()=>l});var r=e(4232);function l(n,t){let e=(0,r.useRef)(t);(0,r.useEffect)(function(){t!==e.current&&null!=n.attributionControl&&(null!=e.current&&n.attributionControl.removeAttribution(e.current),null!=t&&n.attributionControl.addAttribution(t)),e.current=t},[n,t])}},6299:(n,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>x});var r=e(7876),l=e(4232),o=e(8847),u=e(3138),i=e(7152),a=e(1937),c=e(6594),s=e(9458),f=e(1173);e(1782);let d=JSON.parse('{"PolandballNik":"polandball"}');var p=e(9395),g=e(5364);let m=o(()=>e.e(651).then(e.bind(e,1032)).then(n=>n.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),v=o(()=>e.e(651).then(e.bind(e,1032)).then(n=>n.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1});function h(n){let{pinPoint:t,setPinPoint:e,answerShown:r,dest:o,gameOptions:i,ws:a,multiplayerState:c,playSound:s}=n,f=l.useRef(c),d=l.useRef(a);(0,l.useEffect)(()=>{f.current=c},[c]),(0,l.useEffect)(()=>{d.current=a},[a]);let p=(0,u.Po)({click(n){var t,l,o;let u=f.current,i=d.current;if(!r&&(!(null==u?void 0:u.inGame)||(null==u?void 0:u.inGame)&&!(null==u||null==(l=u.gameData)||null==(t=l.players.find(n=>{var t;return n.id===(null==u||null==(t=u.gameData)?void 0:t.myId)}))?void 0:t.final))){if(e(n.latlng),(null==u?void 0:u.inGame)&&(null==(o=u.gameData)?void 0:o.state)==="guess"&&i){let t=[n.latlng.lat,n.latlng.lng];i.send(JSON.stringify({type:"place",latLong:t,final:!1}))}if(n.latlng.lat<-85||n.latlng.lat>85||n.latlng.lng<-270||n.latlng.lng>270){let t=Math.max(-85,Math.min(85,n.latlng.lat)),e=Math.max(-270,Math.min(270,n.latlng.lng));n.target.panTo([t,e],{animate:!0})}}}});(0,l.useEffect)(()=>{let n=null==i?void 0:i.extent;p&&!r&&setTimeout(()=>{try{if(n){let t=L.latLngBounds([n[1],n[0]],[n[3],n[2]]);p.fitBounds(t)}else p.setView([30,0],2)}catch(n){}},500)},[(null==i?void 0:i.extent)?JSON.stringify(i.extent):null,p,r]),(0,l.useEffect)(()=>{t&&setTimeout(()=>{try{let n=L.latLngBounds([t,{lat:o.lat,lng:o.long}]).pad(.5);p.flyToBounds(n,{duration:.5})}catch(n){}},300)},[r]),(0,l.useEffect)(()=>{let n=setInterval(()=>{p.invalidateSize()},5);return()=>clearInterval(n)},[p])}let x=n=>{var t,e,o,u;let{shown:x,options:y,ws:b,session:j,pinPoint:E,setPinPoint:C,answerShown:w,location:O,setKm:z,guessing:R,multiplayerSentGuess:k,multiplayerState:T,showHint:U,round:P,focused:B,gameOptions:I}=n,N=l.useRef(null),S=l.useRef(),{t:A}=(0,f.B)("common"),K=(0,l.useMemo)(()=>({dest:L.icon({iconUrl:"./dest.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src:L.icon({iconUrl:"./src.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src2:L.icon({iconUrl:"./src2.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),polandball:L.icon({iconUrl:"./polandball.png",iconSize:[50,82],iconAnchor:[25,41],popupAnchor:[1,5]})}),[]);(0,l.useEffect)(()=>{if(w&&E&&O){let n=E.distanceTo({lat:O.lat,lng:O.long})/1e3;z(n=n>100?Math.round(n):n>10?parseFloat(n.toFixed(1)):parseFloat(n.toFixed(2)))}},[w,E,O]);let M=L.latLng(-85,-270),_=L.latLng(85,270),H=L.latLngBounds(M,_);return(0,r.jsxs)(m,{center:[0,0],zoom:2,minZoom:2,maxBounds:H,maxBoundsViscosity:.7,worldCopyJump:!0,style:{height:"100%",width:"100%"},whenCreated:n=>{N.current=n},children:[(0,r.jsx)("div",{className:"mapAttr",children:(0,r.jsx)("img",{width:"60",src:"https://lh3.googleusercontent.com/d_S5gxu_S1P6NR1gXeMthZeBzkrQMHdI5uvXrpn3nfJuXpCjlqhLQKH_hbOxTHxFhp5WugVOEcl4WDrv9rmKBDOMExhKU5KmmLFQVg"})}),(0,r.jsx)(h,{playSound:()=>{S.current.play()},pinPoint:E,setPinPoint:C,answerShown:w,dest:O,gameOptions:I,ws:b,multiplayerState:T}),O&&w&&(0,r.jsx)(i.p,{position:{lat:O.lat,lng:O.long},icon:K.dest}),E&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{position:E,icon:"polandball"===d[null==j||null==(t=j.token)?void 0:t.username]?K.polandball:K.src,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:E.lat,lng:E.lng},children:A("yourGuess")})}),w&&O&&(0,r.jsx)(c.R,{positions:[E,{lat:O.lat,lng:O.long}]})]}),(null==T?void 0:T.inGame)&&w&&O&&(null==T||null==(e=T.gameData)?void 0:e.players.map((n,t)=>{var e;if(n.id===(null==T||null==(e=T.gameData)?void 0:e.myId)||!n.guess)return null;let l=g.env.NEXT_PUBLIC_COOLMATH?(0,p.A)(n.username):n.username,o=[n.guess[0],n.guess[1]],u="polandball"===d[l]?K.polandball:K.src2;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{position:{lat:o[0],lng:o[1]},icon:u,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:o[0],lng:o[1]},children:(0,r.jsx)("span",{style:{color:"black"},children:l})})},2*t),(0,r.jsx)(c.R,{positions:[{lat:o[0],lng:o[1]},{lat:O.lat,lng:O.long}],color:"green"},2*t+1)]})})),U&&O&&(0,r.jsx)(s.j,{center:{lat:O.lat,lng:O.long},radius:(o=250*(null==I?void 0:I.maxDist),o)}),(0,r.jsx)(v,{noWrap:!1,url:"https://mt{s}.google.com/vt/lyrs=".concat(null!=(u=null==y?void 0:y.mapType)?u:"m","&x={x}&y={y}&z={z}&hl=").concat(A("lang")),subdomains:["0","1","2","3"],attribution:'\xa9 <a href="https://maps.google.com">Google</a>',maxZoom:22,zoomOffset:0}),(0,r.jsx)("audio",{ref:S,src:"/plop.mp3",preload:"auto"})]})}},6594:(n,t,e)=>{"use strict";e.d(t,{R:()=>i});var r=e(4986),l=e(2526),o=e(5073),u=e(6895);let i=(0,r.Lt)(function({positions:n,...t},e){let r=new u.Polyline(n,t);return(0,l.Q)(r,(0,o.W4)(e,{overlayContainer:r}))},function(n,t,e){t.positions!==e.positions&&n.setLatLngs(t.positions)})},7152:(n,t,e)=>{"use strict";e.d(t,{p:()=>i});var r=e(4986),l=e(2526),o=e(5073),u=e(6895);let i=(0,r.Nq)(function({position:n,...t},e){let r=new u.Marker(n,t);return(0,l.Q)(r,(0,o.W4)(e,{overlayContainer:r}))},function(n,t,e){t.position!==e.position&&n.setLatLng(t.position),null!=t.icon&&t.icon!==e.icon&&n.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==e.zIndexOffset&&n.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==e.opacity&&n.setOpacity(t.opacity),null!=n.dragging&&t.draggable!==e.draggable&&(!0===t.draggable?n.dragging.enable():n.dragging.disable())})},8420:(n,t,e)=>{"use strict";function r(n,t){let e=n.pane??t.pane;return e?{...n,pane:e}:n}e.d(t,{P:()=>r})},9458:(n,t,e)=>{"use strict";e.d(t,{j:()=>a});var r=e(4986),l=e(2526),o=e(5073),u=e(9594),i=e(6895);let a=(0,r.Lt)(function({center:n,children:t,...e},r){let u=new i.Circle(n,e);return(0,l.Q)(u,(0,o.W4)(r,{overlayContainer:u}))},u.s)},9594:(n,t,e)=>{"use strict";function r(n,t,e){t.center!==e.center&&n.setLatLng(t.center),null!=t.radius&&t.radius!==e.radius&&n.setRadius(t.radius)}e.d(t,{s:()=>r})}}]);