(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47],{35:(e,n,t)=>{"use strict";t.d(n,{N:()=>i,V:()=>c});var r=t(4232),l=t(5947),a=t(5073),s=t(1567),o=t(8420);function i(e,n){(0,r.useEffect)(function(){return(n.layerContainer??n.map).addLayer(e.instance),function(){n.layerContainer?.removeLayer(e.instance),n.map.removeLayer(e.instance)}},[n,e])}function c(e){return function(n){let t=(0,a.U$)(),r=e((0,o.P)(n,t),t);return(0,l.z)(t.map,n.attribution),(0,s.x)(r.current,n.eventHandlers),i(r.current,t),r}}},723:(e,n,t)=>{"use strict";t.d(n,{T:()=>a});var r=t(4232),l=t(5073);function a(e){return function(n){let t=(0,l.U$)(),a=e(n,t),{instance:s}=a.current,o=(0,r.useRef)(n.position),{position:i}=n;return(0,r.useEffect)(function(){return s.addTo(t.map),function(){s.remove()}},[t.map,s]),(0,r.useEffect)(function(){null!=i&&i!==o.current&&(s.setPosition(i),o.current=i)},[s,i]),a}}},1567:(e,n,t)=>{"use strict";t.d(n,{x:()=>l});var r=t(4232);function l(e,n){let t=(0,r.useRef)();(0,r.useEffect)(function(){return null!=n&&e.instance.on(n),t.current=n,function(){null!=t.current&&e.instance.off(t.current),t.current=null}},[e,n])}},1782:()=>{},2349:(e,n,t)=>{"use strict";t.d(n,{B7:()=>s,KU:()=>i,jU:()=>o});var r=t(4232),l=t(8477),a=t(5073);function s(e){return(0,r.forwardRef)(function(n,t){let{instance:l,context:s}=e(n).current;return(0,r.useImperativeHandle)(t,()=>l),null==n.children?null:r.createElement(a.hL,{value:s},n.children)})}function o(e){return(0,r.forwardRef)(function(n,t){let[a,s]=(0,r.useState)(!1),{instance:o}=e(n,s).current;(0,r.useImperativeHandle)(t,()=>o),(0,r.useEffect)(function(){a&&o.update()},[o,a,n.children]);let i=o._contentNode;return i?(0,l.createPortal)(n.children,i):null})}function i(e){return(0,r.forwardRef)(function(n,t){let{instance:l}=e(n).current;return(0,r.useImperativeHandle)(t,()=>l),null})}},2526:(e,n,t)=>{"use strict";t.d(n,{K:()=>a,Q:()=>l});var r=t(4232);function l(e,n,t){return Object.freeze({instance:e,context:n,container:t})}function a(e,n){return null==n?function(n,t){let l=(0,r.useRef)();return l.current||(l.current=e(n,t)),l}:function(t,l){let a=(0,r.useRef)();a.current||(a.current=e(t,l));let s=(0,r.useRef)(t),{instance:o}=a.current;return(0,r.useEffect)(function(){s.current!==t&&(n(o,t,s.current),s.current=t)},[o,t,l]),a}}},3138:(e,n,t)=>{"use strict";t.d(n,{Po:()=>o,gY:()=>s,ko:()=>a});var r=t(5073),l=t(4232);function a(){return(0,r.U$)().map}function s(e,n){let t=a();return(0,l.useEffect)(function(){return t.on(e,n),function(){t.off(e,n)}},[t,e,n]),t}function o(e){let n=a();return(0,l.useEffect)(function(){return n.on(e),function(){n.off(e)}},[n,e]),n}},4986:(e,n,t)=>{"use strict";t.d(n,{T7:()=>p,Nq:()=>m,wk:()=>g,Lt:()=>h,X3:()=>x});var r=t(2349),l=t(723),a=t(2526),s=t(35),o=t(5947),i=t(5073),c=t(1567),u=t(8420),d=t(4232);function p(e){let n=(0,a.K)(function(n,t){return(0,a.Q)(e(n),t)}),t=(0,l.T)(n);return(0,r.KU)(t)}function m(e,n){let t=(0,a.K)(e,n),l=(0,s.V)(t);return(0,r.B7)(l)}function g(e,n){var t;let l=(t=(0,a.K)(e),function(e,r){let l=(0,i.U$)(),a=t((0,u.P)(e,l),l);return(0,o.z)(l.map,e.attribution),(0,c.x)(a.current,e.eventHandlers),n(a.current,l,e,r),a});return(0,r.jU)(l)}function h(e,n){var t;let l=(t=(0,a.K)(e,n),function(e){let n=(0,i.U$)(),r=t((0,u.P)(e,n),n);(0,c.x)(r.current,e.eventHandlers),(0,s.N)(r.current,n);var l=r.current;let a=(0,d.useRef)();return(0,d.useEffect)(function(){if(e.pathOptions!==a.current){let n=e.pathOptions??{};l.instance.setStyle(n),a.current=n}},[l,e]),r});return(0,r.B7)(l)}function x(e,n){let t=(0,a.K)(e,n),l=(0,s.V)(t);return(0,r.KU)(l)}},5073:(e,n,t)=>{"use strict";t.d(n,{U$:()=>i,W4:()=>a,fB:()=>l,hL:()=>o});var r=t(4232);function l(e){return Object.freeze({__version:1,map:e})}function a(e,n){return Object.freeze({...e,...n})}let s=(0,r.createContext)(null),o=s.Provider;function i(){let e=(0,r.useContext)(s);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}},5947:(e,n,t)=>{"use strict";t.d(n,{z:()=>l});var r=t(4232);function l(e,n){let t=(0,r.useRef)(n);(0,r.useEffect)(function(){n!==t.current&&null!=e.attributionControl&&(null!=t.current&&e.attributionControl.removeAttribution(t.current),null!=n&&e.attributionControl.addAttribution(n)),t.current=n},[e,n])}},6594:(e,n,t)=>{"use strict";t.d(n,{R:()=>o});var r=t(4986),l=t(2526),a=t(5073),s=t(6895);let o=(0,r.Lt)(function({positions:e,...n},t){let r=new s.Polyline(e,n);return(0,l.Q)(r,(0,a.W4)(t,{overlayContainer:r}))},function(e,n,t){n.positions!==t.positions&&e.setLatLngs(n.positions)})},7047:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>f});var r=t(7876),l=t(4232),a=t(8847),s=t(3138),o=t(7152),i=t(8040),c=t(6594),u=t(1173),d=t(3679),p=t(5259),m=t(8546);t(1782);let g=a(()=>t.e(32).then(t.bind(t,1032)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),h=a(()=>t.e(32).then(t.bind(t,1032)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),x=e=>{let{mapRef:n,onMapReady:t,history:r,onUserInteraction:a}=e,o=(0,s.ko)();return(0,l.useEffect)(()=>{o&&!n.current&&(n.current=o,t(!0),setTimeout(()=>{o.invalidateSize()},100))},[o,n,t]),(0,l.useEffect)(()=>{if(o&&a){let e=()=>{a()};return o.on("zoomstart",e),o.on("movestart",e),o.on("dragstart",e),()=>{o.off("zoomstart",e),o.off("movestart",e),o.off("dragstart",e)}}},[o,a]),null},f=e=>{var n,t,a,s,f,y,v,j,b,w,N,C;let{history:D,points:k,time:L,maxPoints:I,button1Press:z,button1Text:S,button2Press:E,button2Text:R,duel:M,data:F,hidden:T,multiplayerState:O,session:W,gameId:B}=e,{t:A}=(0,u.B)("common"),[P,U]=(0,l.useState)(null),[H,q]=(0,l.useState)(!1),[_,K]=(0,l.useState)(!1),[G,Z]=(0,l.useState)(!1),[$,Q]=(0,l.useState)(null),[V,Y]=(0,l.useState)(!1),[J,X]=(0,l.useState)(!1),[ee,en]=(0,l.useState)(!1),et=(0,l.useRef)(null),er=(0,l.useRef)(null),el=(0,l.useRef)(null),ea=(0,l.useRef)(null),es=(0,l.useRef)(null),[eo,ei]=(0,l.useState)(0),[ec,eu]=(0,l.useState)((null==F?void 0:F.oldElo)||0),[ed,ep]=(0,l.useState)([]),[em,eg]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=()=>{window.L?(er.current=window.L.icon({iconUrl:"./dest.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),el.current=window.L.icon({iconUrl:"./src.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),ea.current=window.L.icon({iconUrl:"./src2.png",iconSize:[30,49],iconAnchor:[15,49],popupAnchor:[1,-34]}),K(!0)):setTimeout(e,100)};e()},[]),(0,l.useEffect)(()=>{if(!M&&k){let e=eo||0,n=Date.now(),t=()=>{let r=Math.min((Date.now()-n)/1200,1);ei(Math.round(e+(k-e)*(r<.7?4*Math.pow(r,3):1-Math.pow(-2*r+2,3)/2))),r<1?requestAnimationFrame(t):ei(k)};requestAnimationFrame(t)}},[k,M]),(0,l.useEffect)(()=>{if(M&&F&&"number"==typeof F.oldElo&&"number"==typeof F.newElo&&!em){let{oldElo:e,newElo:n}=F,t=Math.abs(n-e),r=e,l=setInterval(()=>{eu(r+=r<n?1:-1),r===n&&(clearInterval(l),eg(!0))},t>0?1500/t:0);return()=>clearInterval(l)}},[M,null==F?void 0:F.oldElo,null==F?void 0:F.newElo,em]),(0,l.useEffect)(()=>{let e=()=>{if(es.current){let e=es.current.scrollTop>20;e!==V&&Y(e)}},n=es.current;if(n)return n.addEventListener("scroll",e),()=>n.removeEventListener("scroll",e)},[V]),(0,l.useEffect)(()=>{if(!M&&k&&I){let e=k/I*100,n=[],t="gold",r="/platinum_star.png",l="#CD7F32",a="#b6b2b2";e<=20?n=[a]:e<=30?n=[a,a]:e<=45?n=[a,a,a]:e<=50?n=[l,l,a]:e<=60?n=[l,l,l]:e<=62?n=[t,l,l]:e<=65?n=[t,t,l]:e<=79?n=[t,t,t]:e<=82?n=[r,t,t]:e<=85?n=[r,r,t]:e<=100&&(n=[r,r,r]),ep(n)}},[k,M,I]);let eh=(e,n,t,r)=>{let l=(t-e)*Math.PI/180,a=(r-n)*Math.PI/180,s=Math.sin(l/2)*Math.sin(l/2)+Math.cos(e*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371},ex=e=>e<1?"".concat(Math.round(1e3*e),"m"):e<10?"".concat(e.toFixed(1),"km"):"".concat(Math.round(e),"km"),ef=function(){var e;let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(null==(e=eC[0])?void 0:e.players))return null;let t=Object.entries(eC[0].players).map(e=>{let[n,t]=e;return{playerId:n,username:t.username,totalScore:eC.reduce((e,t)=>{var r,l;return e+((null==(l=t.players)||null==(r=l[n])?void 0:r.points)||0)},0)}}).sort((e,n)=>n.totalScore-e.totalScore);return(n?t:t.slice(0,5)).map((e,n)=>{var t,a,s,o;let i,c=e.playerId===(null==O||null==(t=O.gameData)?void 0:t.myId),u=$===e.playerId;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)("div",{className:"round-item round-animation ".concat(u?"active":""),style:{animationDelay:"".concat(.1*n,"s"),cursor:"pointer"},onClick:()=>{var n;$===(n=e.playerId)?Q(null):Q(n)},children:(0,r.jsxs)("div",{className:"round-header",children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",flex:1},children:[(0,r.jsxs)("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"8px"},children:[0===n&&(0,r.jsx)(d.SBv,{style:{color:"#FFD700",fontSize:"1.2rem",filter:"drop-shadow(0 2px 4px rgba(255, 215, 0, 0.3))"}}),1===n&&(0,r.jsx)(d.SBv,{style:{color:"#C0C0C0",fontSize:"1.1rem",filter:"drop-shadow(0 2px 4px rgba(192, 192, 192, 0.3))"}}),2===n&&(0,r.jsx)(d.SBv,{style:{color:"#CD7F32",fontSize:"1rem",filter:"drop-shadow(0 2px 4px rgba(205, 127, 50, 0.3))"}})]}),(0,r.jsxs)("span",{className:"round-number",children:["#",n+1," ",e.username," ",c&&(0,r.jsxs)("span",{style:{color:"#888",fontStyle:"italic",marginLeft:"4px"},children:["(",A("you"),")"]})]})]}),(i=e.totalScore,(0,r.jsxs)("span",{className:"round-points",style:{color:"white"},children:[i," ",A("pts")]}))]})}),u&&((a=e.playerId)&&(null==(o=eC[0])||null==(s=o.players)?void 0:s[a])?(0,r.jsx)("div",{style:{marginBottom:"16px",padding:"12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:eC.map((e,n)=>{var t;let l=null==(t=e.players)?void 0:t[a];if(!l)return null;let s=l.lat&&l.long?eh(e.lat,e.long,l.lat,l.long):null;return(0,r.jsxs)("div",{style:{padding:"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.05)",marginBottom:"4px",borderRadius:"4px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("span",{style:{color:"white",fontSize:"0.9rem"},children:A("roundNo",{r:n+1})}),(0,r.jsxs)("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[s&&(0,r.jsx)("span",{style:{color:"#aaa",fontSize:"0.8rem"},children:ex(s)}),(0,r.jsxs)("span",{style:{color:"white",fontWeight:"bold"},children:[l.points||0," ",A("pts")]})]})]},n)})}):null)]},e.playerId)})},ey=e=>e>=3e3?"#4CAF50":e>=1500?"#FFC107":"#F44336",ev=function(e,n){let t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=r?"http://maps.google.com/maps?q=&layer=c&panoid=".concat(r,"&cbp=11,0,0,0,0"):"http://maps.google.com/maps?q=&layer=c&cbll=".concat(e,",").concat(n,"&cbp=11,0,0,0,0"),window.open(t,"_blank")},ej=()=>{B&&navigator.clipboard.writeText(B).then(()=>{en(!0),setTimeout(()=>en(!1),2e3)}).catch(()=>{let e=document.createElement("textarea");e.value=B,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),en(!0),setTimeout(()=>en(!1),2e3)})},eb=(e,n)=>{if(n)return"#4CAF50";let t=["#F44336","#2196F3","#FF9800","#9C27B0","#00BCD4"];return t[Math.abs(e.split("").reduce((e,n)=>(e=(e<<5)-e+n.charCodeAt(0))&e,0))%t.length]};(0,l.useEffect)(()=>{H&&eC.length>0&&_&&!J&&setTimeout(()=>{(()=>{if(!et.current||!eC.length||!window.L)return;let e=et.current,n=window.L.latLngBounds();eC.forEach(e=>{n.extend([e.lat,e.long]),e.guessLat&&e.guessLong&&n.extend([e.guessLat,e.guessLong]),e.players&&Object.values(e.players).forEach(e=>{e.lat&&e.long&&n.extend([e.lat,e.long])})});try{n.isValid()&&e.fitBounds(n,{padding:[20,20]})}catch(e){console.error("Error fitting map to bounds:",e)}})()},200)},[H,_,J]);let ew=e=>{U(e),window.innerWidth<=1024?Z(!G):(e=>{if(!et.current||!eC[e]||!window.L)return;let n=eC[e],t=et.current;if(n.guessLat&&n.guessLong){let e=(e=>e<1?15:e<5?13:e<25?11:e<100?9:e<500?7:e<2e3?5:3)(eh(n.lat,n.long,n.guessLat,n.guessLong)),r=window.L.latLngBounds([[n.lat,n.long],[n.guessLat,n.guessLong]]);n.players&&Object.values(n.players).forEach(e=>{e.lat&&e.long&&r.extend([e.lat,e.long])}),t.flyToBounds(r,{padding:[50,50],maxZoom:e,duration:1.5,easeLinearity:.25})}else t.flyTo([n.lat,n.long],10,{duration:1.5,easeLinearity:.25})})(e)},eN=(0,l.useMemo)(()=>{var e;if(D&&D.length>0)return D;if(null==O||null==(e=O.gameData)?void 0:e.roundHistory){let{roundHistory:e,myId:n,duel:t,public:r}=O.gameData;if(t&&!r)return[];if(e&&e.length>0)return e.map((e,t)=>{let r=e.location,l=e.players[n];return{lat:r.lat,long:r.long,guessLat:null==l?void 0:l.lat,guessLong:null==l?void 0:l.long,points:(null==l?void 0:l.points)||0,players:e.players,timeTaken:null}})}return[]},[D,null==O||null==(n=O.gameData)?void 0:n.roundHistory,null==O||null==(t=O.gameData)?void 0:t.myId,null==O||null==(a=O.gameData)?void 0:a.duel,null==O||null==(s=O.gameData)?void 0:s.public]);if(!_||!er.current||!el.current||!ea.current)return(0,r.jsx)("div",{className:"game-summary-container",children:(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"1.5rem"}})});if(!eN||0===eN.length)return(0,r.jsx)("div",{className:"round-over-screen ".concat(T?"hidden":""),children:(0,r.jsx)("div",{className:"game-summary-container",children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",fontSize:"1.5rem",padding:"2rem",textAlign:"center"},children:[(0,r.jsx)("div",{children:"No game history available"}),(0,r.jsxs)("div",{style:{fontSize:"1rem",marginTop:"1rem",opacity:.7},children:["Debug: history=",JSON.stringify(D),", roundHistory length=",null==O||null==(b=O.gameData)||null==(j=b.roundHistory)?void 0:j.length]})]})})});let eC=eN;if(M&&F){let{winner:e,draw:n,oldElo:t,newElo:a}=F,s=a-t;return(0,r.jsx)("div",{className:"round-over-screen ".concat(T?"hidden":""),children:(0,r.jsxs)("div",{className:"game-summary-container",children:[(0,r.jsx)("div",{className:"game-summary-map",children:(0,r.jsxs)(g,{center:[0,0],zoom:2,minZoom:1,maxZoom:18,worldCopyJump:!1,zoomControl:window.innerWidth>1024,style:{height:"100%",width:"100%"},children:[(0,r.jsx)(x,{mapRef:et,onMapReady:q,history:eC,onUserInteraction:()=>X(!0)}),(0,r.jsx)(h,{url:"https://mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&hl=".concat(A("lang"))}),eC.map((e,n)=>{var t;let a=null==O||null==(t=O.gameData)?void 0:t.duel;return(0,r.jsxs)(l.Fragment,{children:[(!a||null===P||P===n)&&(0,r.jsx)(o.p,{position:[e.lat,e.long],icon:er.current,children:(0,r.jsx)(i.z,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:A("roundNo",{r:n+1})}),(0,r.jsx)("br",{}),A("actualLocation"),(0,r.jsx)("div",{style:{marginTop:"8px"},children:(0,r.jsxs)("button",{onClick:()=>ev(e.lat,e.long,e.panoId),style:{background:"#4285f4",color:"white",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:["\uD83D\uDDFA️ ",A("openInMaps")]})})]})})}),e.guessLat&&e.guessLong&&(()=>{var t;return(null==O||null==(t=O.gameData)?void 0:t.duel)&&null!==P&&P!==n?null:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.p,{position:[e.guessLat,e.guessLong],icon:el.current,children:(0,r.jsx)(i.z,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:A("yourGuess")}),(0,r.jsx)("br",{}),A("roundNo",{r:n+1}),(0,r.jsx)("br",{}),e.points," ",A("points")]})})}),(0,r.jsx)(c.R,{positions:[[e.lat,e.long],[e.guessLat,e.guessLong]],color:ey(e.points),weight:3,opacity:.7})]})})(),e.players&&Object.entries(e.players).map(t=>{var a,s;let[u,d]=t;return d.lat&&d.long&&u!==(null==O||null==(a=O.gameData)?void 0:a.myId)?(null==O||null==(s=O.gameData)?void 0:s.duel)&&null!==P&&P!==n?null:(eb(u,!1),(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(o.p,{position:[d.lat,d.long],icon:ea.current,children:(0,r.jsx)(i.z,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:d.username||A("opponent")}),(0,r.jsx)("br",{}),A("roundNo",{r:n+1}),(0,r.jsx)("br",{}),d.points," ",A("points")]})})}),(0,r.jsx)(c.R,{positions:[[e.lat,e.long],[d.lat,d.long]],color:ey(d.points),weight:2,opacity:.5})]},"".concat(n,"-").concat(u))):null})]},n)})]})}),(0,r.jsxs)("div",{className:"game-summary-sidebar ".concat(G?"mobile-expanded":""),children:[(0,r.jsxs)("div",{className:"summary-header duel-header ".concat(V&&window.innerWidth>1024?"compact":""),children:[(0,r.jsx)("h1",{className:"summary-title",children:n?A("draw"):e?A("victory"):A("defeat")}),"number"==typeof F.oldElo&&"number"==typeof F.newElo&&(0,r.jsxs)("div",{className:"elo-container",children:[(0,r.jsxs)("span",{className:"elo-title",children:[A("elo"),":"]}),(0,r.jsxs)("div",{className:"elo-display",children:[(0,r.jsx)("span",{className:"elo-value",children:ec}),(0,r.jsx)("span",{className:"elo-change",style:{color:s>=0?"green":"red"},children:s>0?"+".concat(s):s})]})]}),F.timeElapsed>0&&(0,r.jsxs)("div",{className:"time-elapsed",children:[(0,r.jsx)(d.w_X,{})," ",A("time"),": ",(0,p.A)(F.timeElapsed)]}),B&&(0,r.jsxs)("div",{className:"game-id-container",style:{margin:"12px 0",padding:"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.9rem"},children:[(0,r.jsxs)("span",{style:{color:"white",marginRight:"8px"},children:["ID: ",B]}),(0,r.jsx)("button",{onClick:ej,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",transition:"all 0.2s"},title:"Copy Game ID",children:ee?"✓":"\uD83D\uDCCB"})]}),(0,r.jsxs)("div",{className:"summary-actions",children:[(0,r.jsx)("button",{className:"action-btn mobile-expand-btn",onClick:()=>Z(!G),children:G?A("hideDetails"):A("viewDetails")}),S&&(0,r.jsx)("button",{className:"action-btn primary",onClick:z,children:S}),R&&(0,r.jsx)("button",{className:"action-btn secondary",onClick:E,children:R})]})]}),(0,r.jsxs)("div",{className:"rounds-container ".concat(G?"":"mobile-hidden"),ref:es,children:[(null==O||null==(w=O.gameData)?void 0:w.duel)&&eC.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:A("roundDetails")}),eC.map((e,n)=>{var t,l;let a=null==O||null==(t=O.gameData)?void 0:t.myId,s=null==(l=e.players)?void 0:l[a],o=Object.entries(e.players||{}).filter(e=>{let[n]=e;return n!==a}),i=o.length>0?o[0][1]:null,c=(null==s?void 0:s.points)||0,u=(null==i?void 0:i.points)||0,d=0,p=0;return c<u?d=u-c:u<c&&(p=c-u),(0,r.jsxs)("div",{className:"round-item round-animation ".concat(P===n?"active":""),style:{animationDelay:"".concat(.1*n,"s")},onClick:()=>ew(n),children:[(0,r.jsxs)("div",{className:"round-header",children:[(0,r.jsx)("span",{className:"round-number",children:A("roundNo",{r:n+1})}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.timeTaken&&((null==s?void 0:s.timeTaken)||e.timeTaken)>0&&(0,r.jsxs)("span",{className:"round-points",style:{color:"white"},children:["⏱️ ",(0,m.A)((null==s?void 0:s.timeTaken)||e.timeTaken)]}),window.innerWidth>1024&&e.lat&&e.long&&(0,r.jsx)("button",{className:"gmaps-icon",onClick:n=>{n.stopPropagation(),ev(e.lat,e.long,e.panoId)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"12px",padding:"2px",borderRadius:"3px",backgroundColor:"rgba(255, 255, 255, 0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.2)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",title:A("openInMaps"),children:"\uD83D\uDCCD"})]})]}),(0,r.jsxs)("div",{className:"round-details",children:[(0,r.jsxs)("div",{className:"duel-round-details",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[(0,r.jsxs)("div",{className:"player-score",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[(0,r.jsx)("span",{className:"player-name",style:{fontSize:"0.9em",opacity:"0.8"},children:A("you")}),(0,r.jsxs)("span",{className:"score-points",style:{color:ey(c),fontWeight:"bold"},children:[c," ",A("pts")]}),d>0&&(0,r.jsxs)("span",{className:"health-damage",style:{color:"#ff6b6b",fontSize:"0.85em"},children:["-",d," ❤️"]})]}),!G&&(0,r.jsx)("div",{className:"vs-divider",style:{padding:"0 16px",fontWeight:"bold",color:"rgba(255, 255, 255, 0.6)",fontSize:"0.9em"},children:"VS"}),(0,r.jsxs)("div",{className:"player-score",style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[(0,r.jsx)("span",{className:"player-name",style:{fontSize:"0.9em",opacity:"0.8"},children:(null==i?void 0:i.username)||A("opponent")}),(0,r.jsxs)("span",{className:"score-points",style:{color:ey(u),fontWeight:"bold"},children:[u," ",A("pts")]}),p>0&&(0,r.jsxs)("span",{className:"health-damage",style:{color:"#ff6b6b",fontSize:"0.85em"},children:["-",p," ❤️"]})]})]}),(e.distance||e.timeTaken)&&(0,r.jsx)(r.Fragment,{children:e.distance&&e.distance>0&&(0,r.jsxs)("div",{className:"detail-row",children:[(0,r.jsxs)("span",{className:"detail-label",children:[(0,r.jsx)("span",{className:"detail-icon",children:"\uD83D\uDCCF"}),A("distance")]}),(0,r.jsx)("span",{className:"distance-value",children:ex(e.distance)})]})})]})]},n)})]}),(!(null==O||null==(N=O.gameData)?void 0:N.duel)||Object.keys((null==(C=eC[0])?void 0:C.players)||{}).length>2)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{children:A("finalScores")}),ef(!0)]})]})]})]})})}return(0,r.jsxs)("div",{className:"game-summary-container",children:[(0,r.jsx)("div",{className:"game-summary-map",children:(0,r.jsxs)(g,{center:[0,0],zoom:2,minZoom:1,maxZoom:18,worldCopyJump:!1,zoomControl:window.innerWidth>1024,style:{height:"100%",width:"100%"},children:[(0,r.jsx)(x,{mapRef:et,onMapReady:q,history:D,onUserInteraction:()=>X(!0)}),(0,r.jsx)(h,{url:"https://mt2.google.com/vt/lyrs=m&x={x}&y={y}&z={z}&hl=".concat(A("lang"))}),eC.map((e,n)=>{var t,a;let s=e.guessLat&&e.guessLong?eh(e.lat,e.long,e.guessLat,e.guessLong):null;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(o.p,{position:[e.lat,e.long],icon:er.current,children:(0,r.jsx)(i.z,{className:"map-marker-popup",children:(0,r.jsxs)("div",{className:"popup-content",children:[(0,r.jsxs)("div",{className:"popup-round",children:[A("roundNumber",{number:n+1})," - ",A("actualLocation")]}),(!(null==O?void 0:O.gameData)||!(null==(t=eC[0])?void 0:t.players)||Object.keys(eC[0].players).length<=1)&&(0,r.jsxs)("div",{className:"popup-points",style:{color:ey(e.points)},children:[e.points," ",A("points")]}),s&&(!(null==O?void 0:O.gameData)||!(null==(a=eC[0])?void 0:a.players)||Object.keys(eC[0].players).length<=1)&&(0,r.jsxs)("div",{className:"popup-distance",children:[A("distance"),": ",ex(s)]}),(0,r.jsx)("div",{className:"popup-actions",children:(0,r.jsxs)("button",{className:"popup-btn gmaps",onClick:()=>ev(e.lat,e.long,e.panoId),children:["\uD83D\uDCCD ",A("openInMaps")]})})]})})}),e.guessLat&&e.guessLong&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.p,{position:[e.guessLat,e.guessLong],icon:el.current,children:(0,r.jsx)(i.z,{className:"map-marker-popup",children:(0,r.jsxs)("div",{className:"popup-content",children:[(0,r.jsxs)("div",{className:"popup-round",children:[A("roundNumber",{number:n+1})," - ",A("yourGuess")]}),(0,r.jsxs)("div",{className:"popup-points",style:{color:ey(e.points)},children:[e.points," ",A("points")]}),(0,r.jsxs)("div",{className:"popup-distance",children:[A("distance"),": ",ex(s)]})]})})}),(0,r.jsx)(c.R,{positions:[[e.lat,e.long],[e.guessLat,e.guessLong]],color:ey(e.points),weight:3,opacity:P===n?1:.6})]}),e.players&&Object.entries(e.players).map(t=>{var a,s;let[u,d]=t;if(d.lat&&d.long&&u!==(null==O||null==(a=O.gameData)?void 0:a.myId)){if(null==O||null==(s=O.gameData)?void 0:s.public){if(!$||u!==$)return null}else if($&&u!==$)return null;return eb(u,!1),(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(o.p,{position:[d.lat,d.long],icon:ea.current,children:(0,r.jsx)(i.z,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:d.username||A("opponent")}),(0,r.jsx)("br",{}),A("roundNo",{r:n+1}),(0,r.jsx)("br",{}),d.points," ",A("points")]})})}),(0,r.jsx)(c.R,{positions:[[e.lat,e.long],[d.lat,d.long]],color:ey(d.points),weight:2,opacity:.5})]},"".concat(n,"-").concat(u))}return null})]},n)})]})}),(0,r.jsxs)("div",{className:"game-summary-sidebar ".concat(G?"mobile-expanded":""),children:[(0,r.jsxs)("div",{className:"summary-header ".concat(V&&window.innerWidth>1024?"compact":""),style:{transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",...G&&window.innerWidth<=1024?{padding:"8px 16px",minHeight:"auto",transform:"scale(0.95)"}:{paddingTop:window.innerWidth<1024?"15px":"60px"}},children:[(0,r.jsx)("div",{className:"star-container",style:{transition:"all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)",...G&&window.innerWidth<=1024?{margin:"4px 0",transform:"scale(0.7) translateY(-4px)",opacity:.9}:{}},children:ed.map((e,n)=>(0,r.jsx)("div",{className:"star",style:{animationDelay:"".concat(.5*n,"s"),transition:"transform 0.3s ease-out"},children:"string"==typeof e&&e.endsWith(".png")?(0,r.jsx)("img",{src:e,alt:"Star ".concat(n),style:{width:"32px",height:"32px",transition:"all 0.3s ease-out"}}):(0,r.jsx)(d.gt3,{className:"star",style:{color:e,transition:"all 0.3s ease-out"}})},n))}),(null==O?void 0:O.gameData)&&!(null==O||null==(f=O.gameData)?void 0:f.duel)&&(null==(y=eC[0])?void 0:y.players)&&Object.keys(eC[0].players).length>1&&(()=>{let e=(()=>{var e,n;if(!(null==(e=eC[0])?void 0:e.players)||!(null==O||null==(n=O.gameData)?void 0:n.myId))return null;let t=Object.entries(eC[0].players).map(e=>{let[n,t]=e;return{playerId:n,username:t.username,totalScore:eC.reduce((e,t)=>{var r,l;return e+((null==(l=t.players)||null==(r=l[n])?void 0:r.points)||0)},0)}}).sort((e,n)=>n.totalScore-e.totalScore),r=t.findIndex(e=>{var n;return e.playerId===(null==O||null==(n=O.gameData)?void 0:n.myId)});return -1!==r?{rank:r+1,total:t.length}:null})();return e&&(0,r.jsxs)("div",{style:{color:"white",fontSize:"1.2rem",fontWeight:"bold",textAlign:"center",margin:"8px 0",opacity:.9,transition:"all 0.3s ease-out",...G&&window.innerWidth<=1024?{fontSize:"1rem",margin:"4px 0",transform:"scale(0.9)"}:{}},children:[A("rank")," ",e.rank,"/",e.total]})})(),(0,r.jsx)("div",{className:"summary-score points-display ".concat(eo<k?"animating":""),style:{transition:"all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)",...G&&window.innerWidth<=1024?{fontSize:"1.5rem",margin:"2px 0",transform:"scale(0.9) translateY(-2px)"}:{}},children:(null==eo?void 0:eo.toFixed(0))||k}),(0,r.jsxs)("div",{className:"summary-total",style:{transition:"all 0.3s ease-out",...G&&window.innerWidth<=1024?{fontSize:"0.8rem",margin:"2px 0",opacity:.8,transform:"translateY(-1px)"}:{}},children:[A("outOf")," ",I," ",A("points")]}),B&&(0,r.jsxs)("div",{className:"game-id-container",style:{margin:"12px 0",padding:"8px 12px",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.9rem"},children:[(0,r.jsxs)("span",{style:{color:"white",marginRight:"8px"},children:["ID: ",B]}),(0,r.jsx)("button",{onClick:ej,style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"white",padding:"4px 8px",borderRadius:"4px",cursor:"pointer",fontSize:"0.8rem",transition:"all 0.2s"},title:"Copy Game ID",children:ee?"✓":"\uD83D\uDCCB"})]}),(0,r.jsxs)("div",{className:"summary-actions",children:[(0,r.jsx)("button",{className:"action-btn mobile-expand-btn",onClick:()=>Z(!G),children:G?A("hideDetails"):A("viewDetails")}),S&&(0,r.jsx)("button",{className:"action-btn primary",onClick:z,children:S||"Play Again"}),R&&(0,r.jsx)("button",{className:"action-btn secondary",onClick:E,children:R||"Close"})]})]}),(0,r.jsxs)("div",{className:"rounds-container ".concat(G?"":"mobile-hidden"),ref:es,children:[(null==O?void 0:O.gameData)&&(null==(v=eC[0])?void 0:v.players)&&Object.keys(eC[0].players).length>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:A("finalScores")}),ef(!1)]}),!(null==O?void 0:O.gameData)&&eC&&eC.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{style:{padding:"12px 20px",color:"white",marginBottom:"0",borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},children:A("roundDetails")}),eC.map((e,n)=>{let t=e.guessLat&&e.guessLong?eh(e.lat,e.long,e.guessLat,e.guessLong):null,l=window.innerWidth<=1024;return(0,r.jsxs)("div",{className:"round-item round-animation ".concat(P===n?"active":""),style:{animationDelay:"".concat(.1*n,"s")},onClick:()=>{l?ev(e.lat,e.long,e.panoId):ew(n)},children:[(0,r.jsxs)("div",{className:"round-header",children:[(0,r.jsx)("span",{className:"round-number",children:A("roundNo",{r:n+1})}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,r.jsxs)("span",{className:"round-points",style:{color:"white"},children:[e.points," ",A("pts")]}),!l&&(0,r.jsx)("button",{className:"gmaps-icon",onClick:n=>{n.stopPropagation(),ev(e.lat,e.long,e.panoId)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"12px",padding:"2px",borderRadius:"3px",backgroundColor:"rgba(255, 255, 255, 0.1)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",transition:"background-color 0.2s"},onMouseEnter:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.2)",onMouseLeave:e=>e.target.style.backgroundColor="rgba(255, 255, 255, 0.1)",title:A("openInMaps"),children:"\uD83D\uDCCD"})]})]}),(0,r.jsxs)("div",{className:"round-details",children:[t&&t>0&&(0,r.jsxs)("div",{className:"detail-row",children:[(0,r.jsxs)("span",{className:"detail-label",children:[(0,r.jsx)("span",{className:"detail-icon",children:"\uD83D\uDCCF"}),A("distance")]}),(0,r.jsx)("span",{className:"distance-value",children:ex(t)})]}),e.timeTaken&&e.timeTaken>0&&(0,r.jsxs)("div",{className:"detail-row",children:[(0,r.jsxs)("span",{className:"detail-label",children:[(0,r.jsx)("span",{className:"detail-icon",children:"⏱️"}),A("timeTaken")]}),(0,r.jsx)("span",{className:"time-value",children:(0,m.A)(e.timeTaken)})]}),(()=>{var n;return(null==W||null==(n=W.token)?void 0:n.secret)&&e.xpEarned&&!(e.xpEarned<=0)?(0,r.jsxs)("div",{className:"detail-row",children:[(0,r.jsxs)("span",{className:"detail-label",children:[(0,r.jsx)("span",{className:"detail-icon",children:"⭐"}),"XP"]}),(0,r.jsxs)("span",{className:"xp-value",children:["+",e.xpEarned]})]}):null})()]})]},n)})]})]})]})]})}},7152:(e,n,t)=>{"use strict";t.d(n,{p:()=>o});var r=t(4986),l=t(2526),a=t(5073),s=t(6895);let o=(0,r.Nq)(function({position:e,...n},t){let r=new s.Marker(e,n);return(0,l.Q)(r,(0,a.W4)(t,{overlayContainer:r}))},function(e,n,t){n.position!==t.position&&e.setLatLng(n.position),null!=n.icon&&n.icon!==t.icon&&e.setIcon(n.icon),null!=n.zIndexOffset&&n.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),null!=n.opacity&&n.opacity!==t.opacity&&e.setOpacity(n.opacity),null!=e.dragging&&n.draggable!==t.draggable&&(!0===n.draggable?e.dragging.enable():e.dragging.disable())})},8040:(e,n,t)=>{"use strict";t.d(n,{z:()=>o});var r=t(4986),l=t(2526),a=t(6895),s=t(4232);let o=(0,r.wk)(function(e,n){let t=new a.Popup(e,n.overlayContainer);return(0,l.Q)(t,n)},function(e,n,{position:t},r){(0,s.useEffect)(function(){let{instance:l}=e;function a(e){e.popup===l&&(l.update(),r(!0))}function s(e){e.popup===l&&r(!1)}return n.map.on({popupopen:a,popupclose:s}),null==n.overlayContainer?(null!=t&&l.setLatLng(t),l.openOn(n.map)):n.overlayContainer.bindPopup(l),function(){n.map.off({popupopen:a,popupclose:s}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(l)}},[e,n,r,t])})},8420:(e,n,t)=>{"use strict";function r(e,n){let t=e.pane??n.pane;return t?{...e,pane:t}:e}t.d(n,{P:()=>r})}}]);