(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{3783:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(7876),r=n(4232),a=n(9276),l=n(7328);let c=()=>{let[e,t]=(0,r.useState)({nm:!1,npz:!1,showRoadLabels:!0,lat:null,long:null,panoId:null,heading:null,pitch:null,showAnswer:!1,hidden:!1});return(0,r.useEffect)(()=>{{let e=new URLSearchParams(window.location.search);t({nm:"true"===e.get("nm"),npz:"true"===e.get("npz"),showRoadLabels:"false"!==e.get("showRoadLabels"),lat:parseFloat(e.get("lat")),long:parseFloat(e.get("long")),panoId:e.get("pano")||e.get("panoId"),heading:e.get("heading")?parseFloat(e.get("heading")):null,pitch:e.get("pitch")?parseFloat(e.get("pitch")):null,showAnswer:"true"===e.get("showAnswer"),hidden:"true"===e.get("hidden")})}},[]),(0,r.useEffect)(()=>{let n=n=>{n.data&&"object"==typeof n.data&&"updateProps"===n.data.type&&t({...e,...n.data.props})};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}},[e]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l,{children:(0,o.jsx)("script",{src:"https://maps.googleapis.com/maps/api/js?v=weekly",defer:!0})}),(0,o.jsx)(a.A,{nm:e.nm,npz:e.npz,showRoadLabels:e.showRoadLabels,lat:e.lat,long:e.long,panoId:e.panoId,heading:e.heading,pitch:e.pitch,showAnswer:e.showAnswer,hidden:e.hidden,onLoad:()=>{console.log("StreetView Loaded"),window.parent.postMessage({type:"onLoad"},"*")}})]})}},4551:(e,t,n)=>{"use strict";function o(){try{var e;null==(e=document.querySelector("a[rel=noopener]"))||e.remove()}catch(e){}}n.d(t,{A:()=>o})},7328:(e,t,n)=>{e.exports=n(9836)},7572:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/svEmbed",function(){return n(3783)}])},9276:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var o=n(7876),r=n(4232),a=n(4551);let l=e=>{let{nm:t=!1,npz:n=!1,showRoadLabels:l=!0,lat:c,long:s,panoId:i,heading:u,pitch:d,showAnswer:g=!1,hidden:p=!1,onLoad:h}=e,m=(0,r.useRef)(null),E=(0,r.useRef)(null),w=(0,r.useRef)(null),f=(0,r.useRef)(null),T=(0,r.useRef)(null),S=(0,r.useRef)(null),v=(0,r.useRef)(t),R=(0,r.useRef)(g);(0,r.useEffect)(()=>{let e=Element.prototype.appendChild;Element.prototype.appendChild=function(t){return"SCRIPT"===t.tagName&&t.src.includes("QuotaService.RecordEvent")?t:e.call(this,t)};let t=new MutationObserver(e=>{for(let t of e)for(let e of t.addedNodes)("STYLE"===e.tagName&&"undefined"===e.getAttribute("nonce")||e.innerText.includes(".mapsConsumerUiSceneCoreScene__root")||e.innerText.includes(".dismissButton"))&&e.parentNode.removeChild(e)});return t.observe(document.head,{childList:!0}),()=>{Element.prototype.appendChild=e,t.disconnect()}},[]);let I=(0,r.useRef)(null),V=(0,r.useRef)(!1),L=(0,r.useRef)(!1),_=(0,r.useRef)(!1),[P,b]=(0,r.useState)(!0),y="googlemaps",W=l&&(!t&&!n||t&&n);window.reloadLoc=()=>{if(W){let e=document.getElementById("streetview");e&&(e.src=e.src)}else I.current&&(I.current.setVisible(!1),I.current=null),O()};let N=()=>{document.querySelectorAll('meta[http-equiv="origin-trial"]').forEach(e=>e.remove()),(0,a.A)(),setTimeout(()=>{(0,a.A)()},1e3)},O=()=>{if(console.log("[STREETVIEW] \uD83D\uDE80 initPanorama called with:",{lat:c,long:s,panoId:i,heading:u,pitch:d}),(!c||!s)&&!i||!document.getElementById(y))return void console.log("[STREETVIEW] ❌ Missing required data or DOM element:",{hasLatLong:!!(c&&s),hasPanoId:!!i,hasDomElement:!!document.getElementById(y)});let e={pov:{heading:0,pitch:0},zoom:0,motionTracking:!1,linksControl:g||!t,clickToGo:g||!t,panControl:g||!n,zoomControl:g||!n,showRoadLabels:l,disableDefaultUI:!0};i?(console.log("[STREETVIEW] \uD83D\uDCCD Using panoId:",i),e.pano=i):(console.log("[STREETVIEW] \uD83C\uDF0D Using lat/lng position:",{lat:c,lng:s}),e.position={lat:c,lng:s}),console.log("[STREETVIEW] \uD83D\uDD27 Creating StreetViewPanorama with options:",e),I.current=new google.maps.StreetViewPanorama(document.getElementById(y),e),console.log("[STREETVIEW] ✅ StreetViewPanorama created successfully"),setTimeout(()=>{I.current.setZoom(0)},100),h(),I.current.addListener("pano_changed",()=>{if(console.log("[STREETVIEW] \uD83D\uDCF8 pano_changed event fired"),console.log("[STREETVIEW] \uD83C\uDD94 Current pano ID:",I.current.getPano()),L.current=!0,b(!1),N(),!V.current){console.log("[STREETVIEW] \uD83E\uDDED Setting initial POV to point towards road");let e=I.current.getPhotographerPov();if(console.log("[STREETVIEW] \uD83D\uDCF7 Photographer POV:",e),e&&void 0!==e.heading){let t={heading:e.heading,pitch:0};console.log("[STREETVIEW] ➡️ Setting POV to:",t),I.current.setPov(t),V.current=!0}else console.log("[STREETVIEW] ⚠️ Photographer POV not available or invalid")}I.current.getPano(),I.current.getPosition()}),I.current.addListener("position_changed",()=>{let e=I.current.getPosition(),t=e.lat(),n=e.lng();v.current&&!R.current&&t!==c&&n!==s&&I.current.setPosition({lat:c,lng:s})}),I.current.addListener("pov_changed",()=>{(e=>{let t=Date.now();f.current&&clearTimeout(f.current),S.current={type:"pov_changed",timestamp:t,pov:{heading:e.heading,pitch:e.pitch}},!E.current||t-E.current>=500?E.current=t:f.current=setTimeout(()=>{S.current&&(E.current=Date.now(),S.current=null)},500)})(I.current.getPov())}),I.current.addListener("zoom_changed",()=>{(e=>{let t=Date.now();w.current&&clearTimeout(w.current),T.current={type:"zoom_changed",timestamp:t,zoom:e},!m.current||t-m.current>=500?m.current=t:w.current=setTimeout(()=>{T.current&&(m.current=Date.now(),T.current=null)},500)})(I.current.getZoom())}),I.current.addListener("status_changed",()=>{let e=I.current.getStatus();e===google.maps.StreetViewStatus.ZERO_RESULTS?console.error("[STREETVIEW] ❌ ZERO_RESULTS - No Street View data found for this location"):e===google.maps.StreetViewStatus.UNKNOWN_ERROR?console.error("[STREETVIEW] ❌ UNKNOWN_ERROR - Street View request could not be processed"):e===google.maps.StreetViewStatus.OK&&i&&!_.current&&requestAnimationFrame(()=>{if(!L.current&&!_.current&&P&&(console.log("[STREETVIEW] \uD83D\uDD27 Fallback: pano_changed didn't fire for panoId, handling manually"),_.current=!0,b(!1),N(),!V.current)){let e=I.current.getPhotographerPov();if(console.log("[STREETVIEW] \uD83D\uDCF7 Fallback photographer POV:",e),e&&void 0!==e.heading){let t={heading:e.heading,pitch:0};console.log("[STREETVIEW] ➡️ Fallback setting POV to:",t),I.current.setPov(t),V.current=!0}}})})};return((0,r.useEffect)(()=>(console.log("[STREETVIEW] \uD83D\uDD04 Main useEffect triggered with:",{lat:c,long:s,panoId:i,nm:t,npz:n,showRoadLabels:l,shouldUseEmbed:W}),b(!0),V.current=!1,L.current=!1,_.current=!1,W?(console.log("[STREETVIEW] \uD83D\uDDBC️ Using iframe embed mode"),I.current&&(I.current.setVisible(!1),I.current=null)):(console.log("[STREETVIEW] \uD83D\uDEE0️ Using JS SDK mode"),O()),()=>{w.current&&clearTimeout(w.current),f.current&&clearTimeout(f.current),I.current&&(google.maps.event.clearListeners(I.current,"pano_changed"),google.maps.event.clearListeners(I.current,"position_changed"),google.maps.event.clearListeners(I.current,"pov_changed"),google.maps.event.clearListeners(I.current,"zoom_changed"),google.maps.event.clearListeners(I.current,"visible_changed"),google.maps.event.clearListeners(I.current,"status_changed"),I.current.setVisible(!1),I.current=null)}),[c,s,i,l,W]),(0,r.useEffect)(()=>{v.current=t,R.current=g,W||!I.current||g||(console.log("[STREETVIEW] \uD83C\uDF9B️ Updating panorama options for nm/npz change:",{nm:t,npz:n}),I.current.setOptions({linksControl:g||!t,clickToGo:g||!t,panControl:g||!n,zoomControl:g||!n}))},[t,n,W,g]),(0,r.useEffect)(()=>{g&&!W&&(console.log("temporarily disabling nm,npz"),I.current.setOptions({linksControl:!0,clickToGo:!0,panControl:!0,zoomControl:!0}))},[g]),c&&s||i)?W?(0,o.jsx)("iframe",{className:"".concat(n&&t&&!g?"nmpz":""," ").concat(p?"hidden":""," streetview"),src:i?"https://www.google.com/maps/embed/v1/streetview?pano=".concat(i,"&key=AIzaSyA2fHNuyc768n9ZJLTrfbkWLNK3sLOK-iQ&fov=100&language=iw").concat(null!==u?"&heading=".concat(u):"").concat(null!==d?"&pitch=".concat(d):""):"https://www.google.com/maps/embed/v1/streetview?location=".concat(c,",").concat(s,"&key=AIzaSyA2fHNuyc768n9ZJLTrfbkWLNK3sLOK-iQ&fov=100&language=iw").concat(null!==u?"&heading=".concat(u):"").concat(null!==d?"&pitch=".concat(d):""),referrerPolicy:"no-referrer-when-downgrade",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture",onLoad:()=>{b(!1),h&&(c&&s||i)&&h()},style:{width:"100vw",height:"calc(100vh + 300px)",zIndex:100,transform:"translateY(-285px)"},id:"streetview"}):(0,o.jsx)("div",{id:y,className:"streetview inverted ".concat(P||p?"hidden":"","\n      ").concat(n&&!g?"nmpz":"","\n      ")}):null}}},e=>{e.O(0,[636,593,792],()=>e(e.s=7572)),_N_E=e.O()}]);